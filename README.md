# Understanding and Detecting Crypto-Mining Malware

# Full Unit Project - Robert Holdsworth

## CryptoWebsite
CryptoWebsite is a website made to simulate a sustained high CPU utilisation level that a web-based crypto-mining JavaScript function would usually produce as a symptom for crypto-mining.

### Using CryptoWebsite:
1. Go to its webpage by using the following URL: https://robh0.github.io/HostedCryptoWebsite/
1. Select a number from the drop down menu to determine the duration at which the CPU intensive function should run from. The greater the number the longer the duration the function runs for.
2. Click the 'Start mining' button to start heavy CPU function.
3. An alert will pop up once the heavy CPU function has returned. Press the 'Start mining' button again should wish to start the heavy CPU function again.

## DetectCryptoMining
DetectCryptoMining is a tool written in Python designed to monitor, detect and mitigate against crypto-mining malware.

Please run the tool on Windows 10 since it has been tested on this operating system. Although the components of the tools are OS X and Linux compatible, I have not tested whether all the functionality of the tool works correctly on either of these operating systems.

### Setting up, running the DetectCryptoMining tool:
1. Install required python packages: `pip install PyYAML psutil PyQt5 numpy matplotlib dnspython pywin32`
2. Traverse to the `DetectCryptoMining\DetectCryptoMining.py` file location within the repository.
3. Run the DetectCryptoMining.py file: `python DetectCryptoMining.py`
4. The program will then ask you whether you would like to update the mining pool IP addresses for improved mining detection. If it's your first time running the tool or you haven't updated the IPs for 24hrs enter in `y` for yes. Otherwise enter `n` for no to save time.
5. Once the tool has finished querying for mining pool IP addresses its GUI will popup. Snap the tools GUI to be fullscreen.
6. Next click the 'Start monitoring' button on the GUI to start the program.
7. If at anytime you want to stop the program click the 'Stop monitoring' button.
8. While the tool is running, one can modify the trusted process whitelist by clicking the 'Modify Process Whitelist' button. Clicking the button will cause the whitelist.txt file to be opened with notepad. To add a new trusted process to the whitelist append the process's name to a newline. Any process names added to the whitelist must be in lowercase and verbatim to how Windows names them. To remove a no longer trusted process from the whitelist simply delete its name from the whitelist. Once you have finished updating the whitelist save the document and close it. As soon as the whitelist.txt has been saved the tool will proceed to use the updated whitelist for the next round of monitoring/detection.

### View DetectCryptoMining's Documentation:
1. Traverse into the following directory: `cd DetectCryptoMining\docs\_build\html`
2. Open the index.html file with a browser of your choice. This will display the sphinx generated documentation.

### Testing DetectCryptoMining tool against Xmrig miner on Windows:
1. Make sure you have installed the required python packages for DetectCryptoMining: `pip install PyYAML psutil PyQt5 numpy matplotlib dnspython pywin32`
2. Download the Xmrig miner zip from: https://github.com/xmrig/xmrig/releases
3. Unpack the Xmrig zip.
2. Double click the startTest.bat batch file. This will sequentially start the miner with the correct configurations and then start up the DetectCryptoMining tool ready for testing.
