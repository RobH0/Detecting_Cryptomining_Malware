import unittest
import sys
sys.path.append("..")
from MatchRules import DefineAndCall
from recorder import Recorder

class TestDefineAndCall(unittest.TestCase):

    def test_determineRelevantRule1(self):
        recordClass = Recorder(True)
        testMonData = {'chrome.exe': ['Mem', 1.5], 'xmrig.exe': ['Mem', 5], 'firefox.exe': ['Mem', 0.5]}
        testConfig = {'CPU': ['CPUPercentageCheck', 'SustainedHighCPUCheck'], 'Mem': ['MemoryUsageCheck', 'SustainedHighMemoryCheck']}
        output = DefineAndCall.determineRelevantRule(self, testMonData, testConfig)
        self.assertIsNotNone(output)
        expectedOutput = {'chrome.exe': ['MemoryUsageCheck'], 'xmrig.exe': ['MemoryUsageCheck']}
        self.assertEqual(output, expectedOutput)

if __name__ == '__main__':
    unittest.main()
