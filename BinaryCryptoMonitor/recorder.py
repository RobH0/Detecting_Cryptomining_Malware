from datetime import datetime

class Recorder:

    # Logs rules that have been met at the time they were detected in the format
    # 2020-02-18 15:28:10.982631 | firefox.exe ['CPUPercentageCheck'].
    # param rulesMet: A dictionary whose keys are the supsicous proccesses
    # and the corresponding values are the rules the processes has met during
    # the detection round.
    def writeLog(self, rulesMet):
        formattedLog = str(datetime.now())
        formattedLog += " | "
        index = 0
        lenRuleList = len(rulesMet)

        for key in rulesMet:

            if index != (lenRuleList - 1):
                formattedLog += key + " " + str(rulesMet[key]) + ", "
            else:
                formattedLog += key + " " + str(rulesMet[key]) + "."

        formattedLog += '\n'

        logFile = open("detectionLog.txt", "a")
        logFile.write(formattedLog)
        logFile.close()

    def readLog(self):
        pass
